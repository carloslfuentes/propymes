.wrapper.top
  .grid_6.first
    .grid_6.first
      .panel.padding1
        %a.button.background_green.white#startButton{:style => "width:150px; height:40px;"}
          %h2
            = t :start
        %a.button.background_yellow.white#standbyButton{:style => "width:150px; height:40px;"}
          %h2
            = t :standby
          //Chronometer
        %h0.top.float_right
          #chronometer.gray
        .clear
        //Add Items
        %hr.top
        .padding2
        #add_items.padding3
          .background_gray_clear
            .padding2
              = link_to image_tag("/images/d02/icons/addItem.png", :width => "64px", :style => "margin:0 0 0 66px;"), "#", :id=>"addItem"
              = link_to image_tag("/images/d02/icons/removeItem.png", :width => "64px", :style => "margin:0 0 0 57px;"), "#", :id=>"removeItem"
              %h0.gray.top.float_right
                .top
                  = @working_day.number_piece.to_i.to_s
          .clear
    //Chart 
    .grid_6.panel.first.top.background_gray_clear
      .chart#rate_graph
  
  .grid_2
    .panel.padding1.gray
      //Work Times
      %h3
        = PConfig::WorkTime.model_name.human(:count => :other)
      %table.full.not-style
        %tr
          %td
            = PConfig::WorkTime.model_name.human(:count => 1)
          %td.bold.ar
            = PConfig::WorkTime.total_hours.utc.strftime "%H:%M"
        %tr
          %td
            = t :available_time
          %td.ar
            = @working_day.disponible_time.present? ? (@working_day.disponible_time.utc.strftime "%H:%M") : "00:00" 
        %tr
          %td
            = t :effective_time
          %td.ar
            = @working_day.effective_time.present? ? (@working_day.effective_time.utc.strftime "%H:%M") : "00:00"
      //Progress Production
      %hr/
      .top
        %h3
          = t :production
        %progress{:value => @working_day.nullo.number_piece.if_nil(1), :max => @station.standard.item_number}
        .al.float_left
          = @working_day.nullo.number_piece.to_i.if_nil(0)
        .ar
          = @station.standard.nullo.item_number.if_nil(0)
      //Events
      %hr/
      .top
        %h3
          = PConfig::Event.model_name.human(:count => :other)
        %table.full.not-style
          - @station.events.each do |event|
            %tr.background_gray_clear
              %td.ac
                %h6
                  = event.stoppage_by_category.name
                .ac.not_bold
                  = event.stoppage.name
      //Stop
      %hr/
      .padding3.top.ac
        %a.button.background_red.white#stopButton{:style => "width:120px; height:40px;"}
          %h2
            = t :stop

//Validate Working Day
#validate_status.widget.panel.padding3.background_gray_clear{:style => "height:70px;"}
  .content
    .form
      .clearfix
        = label_tag PConfig::Product.model_name.human(:count => :other)
        = select_tag :product_id, options_for_select(PConfig::Product.for_station(request.ip).map{|prod| [prod.name, prod.id]})
      %hr/
      .ar.top
        %button.button.background_green.white{:href => "#"}
          = t :add
        // FIXME Al tener producto seleccionado si aparecera boton de cancelar
        %a.button.background_gray.gray{:href => "#", :onclick => "$().closeModal();"}
          = t :cancel

:javascript
  $(document).ready(function() {
    //Validate Working Day
    //$("#validate_status").validateStatus("#{@working_day.id}");
    
    //Load Buttons
    resetButtons();
    $('#addItem').click(function() {
      $.post("/home/add_items",{number_piece:1, time:$('#chronometer').text(),working_day_id:#{@working_day.id}}).done(function(data){
        
      });
    });
    
    function resetButtons(){
      //StartButton
      $("#startButton").attr("onclick", "$('#chronometer').chronometer({action:'start', hours:'#{@working_day.effective_time.hour}', minutes:'#{@working_day.effective_time.min}', seconds:'#{@working_day.effective_time.sec}', working_day_id:'#{@working_day.id}'}); this.setAttribute('class','button background_gray white');")
      //StopButton
      $("#stopButton").attr("onclick", "$('#chronometer').chronometer({action:'stop', working_day_id:'#{@working_day.id}'});")
      //StandbyButton
      $("#standbyButton").attr("onclick", "$('#chronometer').chronometer({action:'standby', working_day_id:'#{@working_day.id}'});")
    }
    
    //Chart Rate Graph
    $("#rate_graph").Chart(#{@rate_graph.to_json}, {type:"LineChart", tooltips:false, showLegend:false, formatX:'%X'},{ top:20, right:30, bottom:20, left:30 });
    
  });
